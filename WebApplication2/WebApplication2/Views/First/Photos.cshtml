@model WebApplication2.Models.SettingsModel

@{
    ViewBag.Title = "Photos";
}

@{
    var outputDir = ViewData["OutputDir"];
}

@{
    var path = (outputDir as string) + "\\Thumbnails";
}
<style>
    * {
        box-sizing: border-box;
    }

    .row {
        display: flex;
    }

    /* Create three equal columns that sits next to each other */
    .column {
        flex: 33.33%;
        padding: 5px;
    }

</style>

<h2>Photos</h2>

@{
    //getting array of thumbnails and its length
    string[] arr = Directory.GetFiles(Server.MapPath("~/pictures/Thumbnails"), "*", SearchOption.AllDirectories).ToArray();
    int arrLength = arr.Length;

    //calculating number of rows to show, each row has seven items
    double temp = arrLength / 7.0;
    double numRows = Math.Ceiling(temp);

    //initializing the current photo number to zero
    int photoNum = 0;
}

@for (int k = 0; k < numRows; k++)
{
    //for every row show seven thumbnails, except for the last row
    <div class="row" style="width:200px">
        @for (; photoNum < 7 * (k + 1); photoNum++)
        {
            if (photoNum == arrLength)
            {
                break;
            }
            var item = arr[photoNum];

            <div class="column" style="text-align:center; width:200px;height:242px;border:2px solid #000; margin:2px">
                @{
                    string appPath = HttpContext.Current.Server.MapPath("~");
                    string res = string.Format("{0}", item.Replace(appPath, "").Replace("\\", "/"));

                    //extract date from thumbnail location
                    string[] split = res.Split('/');
                    string year = split[split.Length-3];
                    string month = split[split.Length - 2];
                    string photoDate = month + "/" + year;

                    //extract photo name
                    string photoName = Path.GetFileNameWithoutExtension(res);
                }
                <img src="~/@res" alt="thumb" style="width:150px; height: 150px; border-radius: 50%" />
                <br />
                @photoName
                <br />
                @photoDate
                <br />
                <button onclick="location.href = '@Url.Action("ViewPhoto", "First" , new {name = photoName})';" class="btn btn-primary" style="background-color:blue" type="button">View</button>
                <button onclick="location.href = '@Url.Action("Delete", "First" , new {name = photoName})';" class="btn btn-primary" style="background-color:red" type="button">Delete</button>
            </div>
            <br />
        }
    </div>
}

<br /><br />

<div>
    @Html.ActionLink("Back to Image Web", "Index")
</div>
